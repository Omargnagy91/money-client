<script>
  import GenericDropdown from '@/components/elements/dropdown/generic.svelte';

  import { _ } from 'svelte-i18n';

  export let show = false;
</script>

<style lang="scss">
  @import 'src/styles/importable';

  @keyframes shake {
    0% {
      transform: rotate(3deg);
    }
    50% {
      transform: rotate(-3deg);
    }
  }

  .shake {
    animation: 1s steps(2) shake;
    animation-iteration-count: 3;
  }

  .popover {
    @include mq($until: tablet) {
      --dropdown-min-width: 90vw;
    }
    @include mq($from: tablet) {
      --dropdown-min-width: 300px;
    }
  }
</style>

<div class="popover">
  <GenericDropdown right bind:show>
    <div slot="trigger" let:id let:onTriggerClick>
      <button
        class="button is-small shake"
        class:is-focused={show}
        aria-haspopup="true"
        aria-controls={id}
        on:click={onTriggerClick}>
        <!-- Â© https://teenyicons.com/ cog -->
        <span class="icon is-small">
          <svg
            viewBox="0 0 15 15"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            width="15"
            height="15">
            <path
              clip-rule="evenodd"
              d="M5.944.5l-.086.437-.329 1.598a5.52 5.52 0 00-1.434.823L2.487 2.82l-.432-.133-.224.385L.724 4.923.5 5.31l.328.287 1.244 1.058c-.045.277-.103.55-.103.841 0 .291.058.565.103.842L.828 9.395.5 9.682l.224.386 1.107 1.85.224.387.432-.135 1.608-.537c.431.338.908.622 1.434.823l.329 1.598.086.437h3.111l.087-.437.328-1.598a5.524 5.524 0 001.434-.823l1.608.537.432.135.225-.386 1.106-1.851.225-.386-.329-.287-1.244-1.058c.046-.277.103-.55.103-.842 0-.29-.057-.564-.103-.841l1.244-1.058.329-.287-.225-.386-1.106-1.85-.225-.386-.432.134-1.608.537a5.52 5.52 0 00-1.434-.823L9.142.937 9.055.5H5.944z"
              stroke="currentColor"
              stroke-linecap="square"
              stroke-linejoin="round" />
            <path
              clip-rule="evenodd"
              d="M9.5 7.495a2 2 0 01-4 0 2 2 0 014 0z"
              stroke="currentColor"
              stroke-linecap="square"
              stroke-linejoin="round" />
          </svg>
        </span>
        <span>{$_('cmps.nav.menu.settings')}</span>
      </button>
    </div>

    <div class="px-4 py-3">
      <slot />
    </div>
  </GenericDropdown>
</div>
